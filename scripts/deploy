#!/usr/bin/env bash
set -e

CWD="${0%/*}"
LIB=$CWD/../lib
OUT=$CWD/../out
mkdir -p $OUT

cd $LIB/dss-deploy/
source bin/deploy-all
cd -

cat > $OUT/addresses.json <<- EOM
{
  "MCD_DEPLOY": "$MCD_DEPLOY",
  "MCD_GOV": "$MCD_GOV",
  "MCD_VAT": "$MCD_VAT",
  "MCD_PIT": "$MCD_PIT",
  "MCD_DRIP": "$MCD_DRIP",
  "MCD_CAT": "$MCD_CAT",
  "MCD_VOW": "$MCD_VOW",
  "MCD_MCD": "$MCD_MCD",
  "MCD_JOIN_DAI": "$MCD_JOIN_DAI",
  "MCD_MOVE_DAI": "$MCD_MOVE_DAI",
  "MCD_FLAP": "$MCD_FLAP",
  "MCD_FLOP": "$MCD_FLOP",
  "MCD_MOM": "$MCD_MOM",
  "MCD_DAI": "$MCD_DAI",
  "MCD_DAI_GUARD": "$MCD_DAI_GUARD",
  "PIP_DGX": "$PIP_DGX",
  "MCD_JOIN_DGX": "$MCD_JOIN_DGX",
  "MCD_MOVE_DGX": "$MCD_MOVE_DGX",
  "MCD_FLIP_DGX": "$MCD_FLIP_DGX",
  "MCD_SPOT_DGX": "$MCD_SPOT_DGX",
  "PIP_ETH": "$PIP_ETH",
  "MCD_JOIN_ETH": "$MCD_JOIN_ETH",
  "MCD_MOVE_ETH": "$MCD_MOVE_ETH",
  "MCD_FLIP_ETH": "$MCD_FLIP_ETH",
  "MCD_SPOT_ETH": "$MCD_SPOT_ETH",
  "PIP_REP": "$PIP_REP",
  "REP": "$REP",
  "MCD_JOIN_REP": "$MCD_JOIN_REP",
  "MCD_MOVE_REP": "$MCD_MOVE_REP",
  "MCD_FLIP_REP": "$MCD_FLIP_REP",
  "MCD_SPOT_REP": "$MCD_SPOT_REP"
}
EOM

$CWD/collect-abis
